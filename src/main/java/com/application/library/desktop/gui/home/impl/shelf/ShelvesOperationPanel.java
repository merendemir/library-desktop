package com.application.library.desktop.gui.home.impl.shelf;

import com.application.library.desktop.gui.home.impl.panel.main.IMainPanel;
import com.application.library.desktop.gui.home.impl.shelf.ShowShelvesPanel;
import com.application.library.desktop.gui.home.impl.shelf.ShelvesPanelCreateService;
import com.application.library.desktop.gui.home.impl.shelf.menu.ShelvesPopupMenu;
import com.application.library.desktop.gui.table.CustomDataTable;
import org.springframework.stereotype.Service;

import javax.swing.*;
import java.awt.*;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

@Service
public class ShelvesOperationPanel extends JPanel implements IMainPanel {
    private final ShowShelvesPanel showShelvesPanel;
    private final ShelvesPopupMenu shelvesPopupMenu;

    public ShelvesOperationPanel(ShelvesPanelCreateService shelvesPanelCreateService, ShelvesPopupMenu shelvesPopupMenu) {
        showShelvesPanel = shelvesPanelCreateService.createNewShelvesPanel();
        $$$setupUI$$$();

        setLayout(new BorderLayout());
        add(contentPane, BorderLayout.CENTER);

        this.shelvesPopupMenu = shelvesPopupMenu;
        setComponentActions();
    }

    private void setComponentActions() {
        CustomDataTable shelvesDataTable = showShelvesPanel.getShelvesDataTable();
        shelvesDataTable.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent e) {
                if (SwingUtilities.isRightMouseButton(e)) {
                    int row = shelvesDataTable.rowAtPoint(e.getPoint());
                    shelvesDataTable.setRowSelectionInterval(row, row);

                    shelvesPopupMenu.setSelectedShelfId(showShelvesPanel.getSelectedShelf());
                    shelvesPopupMenu.showPopupMenu(e.getComponent(), e.getX(), e.getY());
                }
            }
        });
    }


    private void createUIComponents() {
        contentPane = showShelvesPanel;
    }

    //COMPONENTS
    private JPanel contentPane;

    /**
     * Method generated by IntelliJ IDEA GUI Designer
     * >>> IMPORTANT!! <<<
     * DO NOT edit this method OR call it in your code!
     *
     * @noinspection ALL
     */
    private void $$$setupUI$$$() {
        createUIComponents();
    }

    /**
     * @noinspection ALL
     */
    public JComponent $$$getRootComponent$$$() {
        return contentPane;
    }

    @Override
    public void selected() {
        showShelvesPanel.selected();
    }
}
